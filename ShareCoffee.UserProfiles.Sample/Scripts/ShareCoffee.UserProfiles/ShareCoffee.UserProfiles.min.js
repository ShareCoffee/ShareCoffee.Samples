/* ShareCoffee.UserProfiles (c) 2013 Thorsten Hans | dotnet-rocks.com | https://github.com/ThorstenHans/ShareCoffee.UserProfiles/ | under MIT License | */(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].slice;if(a="undefined"!=typeof global&&null!==global?global:window,null==a.ShareCoffee||null==a.ShareCoffee.REST)throw new Error("LoadError");null==a.ShareCoffee.Url&&(a.ShareCoffee.Url={}),a.ShareCoffee.Url.SetMyProfilePicture="SP.UserProfiles.PeopleManager/SetMyProfilePicture",a.ShareCoffee.Url.GetMyProperties="SP.UserProfiles.PeopleManager/GetMyProperties",a.ShareCoffee.Url.GetProperties="SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v=",a.ShareCoffee.Url.GetUserProfileProperty="SP.UserProfiles.PeopleManager/GetUserProfilePropertyFor(accountName=@v, propertyName=@p)?@v=&@p=",a.ShareCoffee.ProfilePictureProperties=function(){function a(a,c,d){this.profilePicture=a,this.onSuccess=c,this.onError=d,this.getRequestProperties=b(this.getRequestProperties,this),null==this.profilePicture&&(this.profilePicture=null),null==this.onSuccess&&(this.onSuccess=null),null==this.onError&&(this.onError=null),this.url=ShareCoffee.Url.SetMyProfilePicture}return a.prototype.getRequestProperties=function(){var a;return a=this.profilePicture,new ShareCoffee.REST.RequestProperties(this.url,a,null,null,this.onSuccess,this.onError)},a}(),a.ShareCoffee.UserProfileProperties=function(){function a(){var a,d,e,f,g;g=arguments[0],a=arguments[1],e=arguments[2],d=arguments[3],f=5<=arguments.length?c.call(arguments,4):[],this.url=g,this.accountName=null!=a?a:null,this.onSuccess=null!=e?e:null,this.onError=null!=d?d:null,this.propertyNames=f,this.getRequestProperties=b(this.getRequestProperties,this),this.getUrl=b(this.getUrl,this),null==this.accountName&&(this.accountName=null),null==this.propertyNames&&(this.propertyNames=null),null==this.onSuccess&&(this.onSuccess=null),null==this.onError&&(this.onError=null),null==this.url&&(this.url=null)}return a.prototype.getUrl=function(){var a,b,c,d,e,f;if(c=this.url,c.indexOf("@v")>-1){if(null==this.accountName)throw new Error("AccountName not specified");c=c.replace("@v=","@v='"+encodeURIComponent(this.accountName)+"'")}if(c.indexOf("@p")>-1){if(b="PreferredName",null==this.propertyNames||0===this.propertyNames.length)throw new Error("PropertyName not specified");this.propertyNames.length>0&&(b=this.propertyNames[0]),c=c.replace("@p=","@p='"+b+"'")}if(c.indexOf(ShareCoffee.Url.GetMyProperties)>-1&&this.propertyNames.length>0){if(null==this.propertyNames||0===this.propertyNames.length)throw new Error("PropertyNames not specified");for(b="",f=this.propertyNames,d=0,e=f.length;e>d;d++)a=f[d],b+=""+a+",";b=b.substr(0,b.length-1),c=""+c+"?$select="+b}return c},a.prototype.getRequestProperties=function(){return new ShareCoffee.REST.RequestProperties(this.getUrl(),null,null,null,this.onSuccess,this.onError)},a}()}).call(this);